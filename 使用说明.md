# AI 对话应用使用说明

## 功能概览

面向后端 API 的对话应用，使用 OkHttp 直连 Spring Boot 后端并以 SSE 文本流方式接收增量回复；支持账号密码登录/注册、短期免登录、模型切换、图片上传（缩略图显示）、历史记录。

## 主要特性

- SSE 流式回复（`Accept: text/event-stream`）
- 账号密码认证（登录/注册）与令牌 TTL/过期时间管理
- 保存后端地址与“测试连接”按钮（/health、/actuator/health、/auth/login 回退）
- 模型切换与多模态图片上传（MIME/大小校验）
- Room 持久化与分页，Compose 现代化 UI

## 运行与联调

- 后端启动：监听 `8080`，建议 `0.0.0.0`；放行 Windows 防火墙 TCP 8080
- 地址选择：
  - 真机 + USB：执行 `adb reverse tcp:8080 tcp:8080`，App 地址 `http://127.0.0.1:8080`
  - 模拟器：`http://10.0.2.2:8080`
  - 局域网：`http://<电脑IP>:8080`
- 登录页操作：
  - 输入账号、密码（注册需确认密码）
  - 在“后端地址”输入框保存地址并点击“测试连接”
  - 登录或注册后进入聊天界面

## 常见问题定位

- 连接失败：
  - 地址不合法或协议缺失，使用 `http://<IP>:<PORT>` 格式
  - 防火墙未放行 8080 或后端未监听 `0.0.0.0`
  - 真机未执行 `adb reverse` 且地址为 `127.0.0.1`
- 注册提示“两次输入的密码不一致”：确认两次密码完全一致且长度 ≥ 8
- 返回 429/forbidden：并发过多或会话无权限，稍后重试或检查令牌

## 项目结构（关键文件）

- `app/src/main/java/com/example/aichat10/viewmodel/AuthViewModel.kt`（认证、地址保存与测试）
- `app/src/main/java/com/example/aichat10/viewmodel/ChatViewModel.kt`（SSE、模型与图片上传）
- `app/src/main/java/com/example/aichat10/ui/components/LoginScreen.kt`（登录/注册界面）
- `app/src/main/java/com/example/aichat10/ui/components/ChatScreen.kt`（聊天界面）

## 版本信息

**版本**: 1.1  
**更新日期**: 2025-12-05
